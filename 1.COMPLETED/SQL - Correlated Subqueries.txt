1) Display highest paid employee details for each grade by deptno.

select *
from emp , salgrade 
where emp.sal between salgrade.losal and salgrade.hisal 
and (sal,grade) in (select max(sal), grade from emp , salgrade 
where emp.sal between salgrade.losal and salgrade.hisal group by deptno , grade)
order by deptno, grade;

--or

SELECT ENAME, DEPTNO, SAL, GRADE 
FROM EMP E, SAL_GRADE S
WHERE (SAL, GRADE, DEPTNO) IN 
(SELECT MAX(SAL), GRADE, DEPTNO
FROM EMP E1, SAL_GRADE S1
WHERE E1.SAL BETWEEN S.LOSAL AND S.HISAL
GROUP BY GRADE,DEPTNO)
ORDER BY DEPTNO;

--OR

SELECT EMPNO, ENAME, SAL, GRADE, DEPTNO
FROM EMP E, SAL_GRADE S
WHERE SAL IN (SELECT MAX(SAL) FROM EMP E1, SAL_GRADE S1
WHERE SAL BETWEEN S1.LOSAL AND S1.HISAL AND S1.GRADE = S.GRADE AND E1.DEPTNO = E.DEPTNO)
ORDER BY DEPTNO;



2) Display Senior most employee of each location.



SELECT E.ENAME, D.LOC, TRUNC(MONTHS_BETWEEN(SYSDATE,E.HIREDATE)/12,4) AS EXP
FROM EMP E, DEPT D
WHERE (MONTHS_BETWEEN(SYSDATE,E.HIREDATE), D.LOC) IN 
(SELECT MAX(MONTHS_BETWEEN(SYSDATE,E1.HIREDATE)), D1.LOC
FROM EMP E1, DEPT D1
WHERE E1.DEPTNO = D1.DEPTNO
GROUP BY D1.LOC);

--(or)

SELECT ENAME, LOC, HIREDATE 
FROM EMP, DEPT
WHERE (HIREDATE, LOC) IN (SELECT MIN(HIREDATE), LOC 
FROM EMP, DEPT
where emp.deptno = dept.deptno
GROUP BY LOC);



3) Display Senior most employee working as Manager for each Deptno.

SELECT E.ENAME, D.DEPTNO, TRUNC(MONTHS_BETWEEN(SYSDATE,E.HIREDATE)/12,4) AS EXP
FROM EMP E, DEPT D
WHERE (MONTHS_BETWEEN(SYSDATE,E.HIREDATE), D.DEPTNO) IN 
(SELECT MAX(MONTHS_BETWEEN(SYSDATE,E1.HIREDATE)), D1.DEPTNO
FROM EMP E1, DEPT D1
WHERE E1.DEPTNO = D1.DEPTNO AND JOB='MANAGER'
GROUP BY D1.DEPTNO);

--OR

SELECT E.ENAME, E.DEPTNO, E.HIREDATE FROM EMP E
WHERE (E.HIREDATE) IN 
(SELECT MIN(E1.HIREDATE) FROM EMP E1
WHERE E1.DEPTNO = E.DEPTNO  AND JOB='MANAGER' );



4) Display lowest paid employee for each Job by Deptno


SELECT * FROM EMP 
WHERE (SAL, JOB, DEPTNO) IN (SELECT MIN(SAL), JOB, DEPTNO
FROM EMP
GROUP BY JOB,DEPTNO)
ORDER BY DEPTNO;




5) Display employees who are earning morethan average salary of their own Job and Deptno combination.

SELECT E1.*
FROM EMP E1
WHERE E1.SAL > (SELECT AVG(SAL) FROM EMP E2
WHERE E2.JOB = E1.JOB) AND E1.SAL > (SELECT AVG(SAL) FROM EMP E3
WHERE E3.DEPTNO = E1.DEPTNO);



6) Display year wise highest paid employees.

SELECT * 
FROM EMP E1
WHERE SAL IN ( SELECT MAX(SAL)
FROM EMP E2
WHERE TO_CHAR(HIREDATE,'YYYY') = TO_CHAR(E1.HIREDATE, 'YYYY')
) ORDER BY HIREDATE;


7) Display year wise highest paid employees BY DEPTNO.

SELECT *
FROM EMP E
WHERE SAL IN (SELECT MAX(SAL) FROM EMP E1
WHERE E1.DEPTNO = E.DEPTNO AND 
TO_CHAR(E1.HIREDATE,'YYYY') = TO_CHAR(E.HIREDATE,'YYYY'))
ORDER BY DEPTNO; 


8) Display year wise highest paid employees BY LOCATION.

SELECT E.EMPNO, E.ENAME, E.HIREDATE, E.DEPTNO, D.LOC
FROM EMP E,DEPT D
WHERE SAL IN (SELECT MAX(SAL) FROM EMP E1, DEPT D1
WHERE D1.LOC = D.LOC AND E1.DEPTNO = D1.DEPTNO AND
TO_CHAR(E1.HIREDATE,'YYYY') = TO_CHAR(E.HIREDATE,'YYYY'))
ORDER BY LOC; 


9) Display MGR wise highest paid employees.


SELECT * 
FROM EMP E
WHERE (SAL) IN (SELECT MAX(SAL)
FROM EMP E1
WHERE E1.MGR = E.MGR)
ORDER BY MGR;


10) Display first employee joined for each manager.

SELECT * 
FROM EMP E 
WHERE (HIREDATE) IN (SELECT MIN(HIREDATE)
FROM EMP E1
WHERE E1.MGR = E.MGR)
ORDER BY MGR;




